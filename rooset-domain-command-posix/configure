#!/bin/bash
set -o errexit -o nounset -o pipefail

# Workingdirection is rooset base dir
SCRIPTDIR=`dirname "$(readlink -f "$0")"`
WORKDIR=${SCRIPTDIR}/build
mkdir -p ${WORKDIR}
cd ${WORKDIR}

# configure for clang
cmake -DCMAKE_C_COMPILER=/usr/bin/clang -DCMAKE_CXX_COMPILER=/usr/bin/clang++ ../

# build executables, run unit tests
make
./rooset-unit-tests
./rooset-generated-tests
make test
